<?xml version="1.0" encoding="UTF-8" ?>
<class name="Luau" inherits="Object" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://raw.githubusercontent.com/godotengine/godot/master/doc/class.xsd">
	<brief_description>
		Static class for compiling Luau source code to bytecode and providing Lua C API utility functions.
	</brief_description>
	<description>
		The [Luau] class provides static methods for compiling Luau source code to bytecode and utility functions from the Lua C API.
		Luau is a fast, small, safe scripting language derived from Lua 5.1 with performance optimizations and a gradual type system.
		This class also exposes constants and enums from the Lua C API, such as status codes ([constant LUA_OK], [constant LUA_YIELD], etc.) and type identifiers ([constant LUA_TNIL], [constant LUA_TNUMBER], etc.).
	</description>
	<tutorials>
	</tutorials>
	<methods>
		<method name="compile" qualifiers="static">
			<return type="PackedByteArray" />
			<param index="0" name="source_code" type="String" />
			<description>
				Compiles Luau source code to bytecode. Returns a [PackedByteArray] containing the compiled bytecode.
				[codeblock]
				var bytecode := Luau.compile("return 1 + 2")
				var state := LuaState.new()
				var result := state.load_bytecode(bytecode, "chunk")
				if result == LuaState.LUA_OK:
					state.pcall(0, 1, 0)
					print(state.to_number(-1))  # Prints 3
				[/codeblock]
			</description>
		</method>
		<method name="is_pseudo" qualifiers="static">
			<return type="bool" />
			<param index="0" name="index" type="int" />
			<description>
				Returns [code]true[/code] if the given stack index is a pseudo-index (e.g., [constant LUA_REGISTRYINDEX], [constant LUA_GLOBALSINDEX]).
			</description>
		</method>
		<method name="upvalue_index" qualifiers="static">
			<return type="int" />
			<param index="0" name="upvalue" type="int" />
			<description>
				Returns the index of upvalue [param upvalue] as it exists on the stack.
			</description>
		</method>
	</methods>
	<constants>
		<constant name="LUA_MULTRET" value="-1">
			Used for [code]nresults[/code] with functions like [LuaState.call] to indicate that all results, however many, should be returned.
		</constant>
		<constant name="LUA_REGISTRYINDEX" value="-10000">
			Pseudo-index for the Lua registry table, which can be used by the host application to store arbitrary values associated with a Lua state.
		</constant>
		<constant name="LUA_ENVIRONINDEX" value="-10001">
			Pseudo-index for the Lua environment table, which contains the environment for the currently executing [i]host[/i] function.
		</constant>
		<constant name="LUA_GLOBALSINDEX" value="-10002">
			Pseudo-index for the Lua globals table, which contains the environment for the current thread (Lua state).
		</constant>
		<constant name="LUA_OK" value="0" enum="lua_Status">
			Indicates successful completion.
		</constant>
		<constant name="LUA_YIELD" value="1" enum="lua_Status">
			Indicates that the coroutine yielded.
		</constant>
		<constant name="LUA_ERRRUN" value="2" enum="lua_Status">
			Indicates a runtime error.
		</constant>
		<constant name="LUA_ERRSYNTAX" value="3" enum="lua_Status">
			Indicates a syntax error. This is a legacy Lua 5.1 error code, and isn't generated by Luau.
		</constant>
		<constant name="LUA_ERRMEM" value="4" enum="lua_Status">
			Indicates a memory allocation error.
		</constant>
		<constant name="LUA_ERRERR" value="5" enum="lua_Status">
			Indicates an error while running the error handler function.
		</constant>
		<constant name="LUA_BREAK" value="6" enum="lua_Status">
			Indicates that the coroutine yielded for a debug breakpoint.
		</constant>
		<constant name="LUA_CORUN" value="0" enum="lua_CoStatus">
			Indicates that the coroutine is running.
		</constant>
		<constant name="LUA_COSUS" value="1" enum="lua_CoStatus">
			Indicates that the coroutine is suspended.
		</constant>
		<constant name="LUA_CONOR" value="2" enum="lua_CoStatus">
			Indicates that the coroutine is in "normal" state (it resumed another coroutine).
		</constant>
		<constant name="LUA_COFIN" value="3" enum="lua_CoStatus">
			Indicates that the coroutine has finished execution.
		</constant>
		<constant name="LUA_COERR" value="4" enum="lua_CoStatus">
			Indicates that the coroutine finished with an error.
		</constant>
		<constant name="LUA_TNONE" value="-1">
			Pseudo-type representing no value.
		</constant>
		<constant name="LUA_TNIL" value="0" enum="lua_Type">
			Type representing the absence of a value.
		</constant>
		<constant name="LUA_TBOOLEAN" value="1" enum="lua_Type">
			Type representing a boolean.
		</constant>
		<constant name="LUA_TLIGHTUSERDATA" value="2" enum="lua_Type">
			Type representing a "light userdata," which is an opaque pointer.
		</constant>
		<constant name="LUA_TNUMBER" value="3" enum="lua_Type">
			Type representing a number. All numbers in Luau are floating point, even if they are representable as integers.
		</constant>
		<constant name="LUA_TVECTOR" value="4" enum="lua_Type">
			Type representing a 3-component vector (x, y, z). The [code]vector[/code] library can be used to manipulate these.
		</constant>
		<constant name="LUA_TSTRING" value="5" enum="lua_Type">
			Type representing a string.
		</constant>
		<constant name="LUA_TTABLE" value="6" enum="lua_Type">
			Type representing a table. Tables are used in Luau to represent both arrays and dictionaries.
		</constant>
		<constant name="LUA_TFUNCTION" value="7" enum="lua_Type">
			Type representing a Luau function.
		</constant>
		<constant name="LUA_TUSERDATA" value="8" enum="lua_Type">
			Type representing a "full userdata," which is a custom object managed by Luau.
		</constant>
		<constant name="LUA_TTHREAD" value="9" enum="lua_Type">
			Type representing a Lua thread (coroutine).
		</constant>
		<constant name="LUA_TBUFFER" value="10" enum="lua_Type">
			Type representing a Luau buffer, a fixed-size mutable block of memory. The [code]buffer[/code] library can be used to manipulate these.
Not to be confused with Lua string buffers.
		</constant>
		<constant name="LUA_TPROTO" value="11" enum="lua_Type">
			Type representing a Luau function prototype. This will only show up in garbage collection and debugging APIs.
		</constant>
		<constant name="LUA_TUPVAL" value="12" enum="lua_Type">
			Type representing a Luau upvalue. This will only show up in garbage collection and debugging APIs.
		</constant>
		<constant name="LUA_TDEADKEY" value="13" enum="lua_Type">
			Type representing a "dead key" in a table. This will only show up in garbage collection and debugging APIs.
		</constant>
		<constant name="LUA_T_COUNT" value="11" enum="lua_Type">
			Number of Lua types.
		</constant>
		<constant name="LUA_GCSTOP" value="0" enum="lua_GCOp">
			Stop incremental garbage collection.
		</constant>
		<constant name="LUA_GCRESTART" value="1" enum="lua_GCOp">
			Resume incremental garbage collection.
		</constant>
		<constant name="LUA_GCCOLLECT" value="2" enum="lua_GCOp">
			Run a full GC cycle. Not recommended for latency sensitive applications.
		</constant>
		<constant name="LUA_GCCOUNT" value="3" enum="lua_GCOp">
			Return the heap size in KB.
		</constant>
		<constant name="LUA_GCCOUNTB" value="4" enum="lua_GCOp">
			Return the remainder of the heap size (after [LUA_GCCOUNT]) in bytes.
		</constant>
		<constant name="LUA_GCISRUNNING" value="5" enum="lua_GCOp">
			Return whether the garbage collector is running. Note that the GC may not be actively collecting even if it's running.
		</constant>
		<constant name="LUA_GCSTEP" value="6" enum="lua_GCOp">
			Perform an explicit GC step, with the step size specified in KB.
Garbage collection is handled by "assists" that perform some amount of GC work matching the pace of allocation. Explicit GC steps allow you to perform some amount of work at custom points to offset the need for GC assists.
Note that GC might also be paused for some duration (until bytes allocated meet the threshold). If an explicit step is performed during this pause, it will trigger the start of the next collection cycle.
		</constant>
		<constant name="LUA_GCSETGOAL" value="7" enum="lua_GCOp">
			Tune GC parameter [code]G[/code] (goal).
Garbage collection is incremental and tries to maintain the heap size to balance memory and performance overhead. This overhead is determined by [code]G[/code] (goal) which is the ratio between total heap size and the amount of live data in it. [code]G[/code] is specified in percentages; by default, [code]G[/code] is 200%, which means that the heap is allowed to grow to ~2x the size of live data.
		</constant>
		<constant name="LUA_GCSETSTEPMUL" value="8" enum="lua_GCOp">
			Tune GC parameter [code]S[/code] (step multiplier).
The collector tries to collect [code]S%[/code] of allocated bytes by interrupting the application after [code]step size[/code] bytes were allocated. When [code]S[/code] is too small, the collector may not be able to catch up, and the effective goal that can be reached will be larger. [code]S[/code] is specified in percentages; by default, [code]S[/code] is 200%, which means that collector will run at ~2x the pace of allocations.
It is recommended to set [code]S[/code] in the interval [code][100 / (G - 100), 100 + 100 / (G - 100)][/code] with a minimum value of 150%; for example:
- For [code]G=200%[/code], [code]S[/code] should be in the interval [code][150%, 200%][/code]
- For [code]G=150%[/code], [code]S[/code] should be in the interval [code][200%, 300%][/code]
- For [code]G=125%[/code], [code]S[/code] should be in the interval [code][400%, 500%][/code]
		</constant>
		<constant name="LUA_GCSETSTEPSIZE" value="9" enum="lua_GCOp">
			Tune GC step size. This is usually best left ignored.
		</constant>
		<constant name="LUA_NOREF" value="-1">
			A constant guaranteed to be different from any reference returned by [LuaState.ref].
		</constant>
		<constant name="LUA_REFNIL" value="0">
			A constant returned when attempting to generate a reference to a [code]nil[/code] value.
		</constant>
	</constants>
</class>
